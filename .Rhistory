#For competitions 1-2
tot2 <- bind_rows(comp1, comp2)
View(tot2)
# Add new variable "points"
tot <- comp1 %>% mutate(points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
View(tot)
## Calculate grand total points for all competitions (1-2)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
# Create a table with the DT package
datatable( tot,
colnames = c("Namn" = "Name", "Placering" = "Place", "Poäng" = "Points"),
caption = "Tabell 1: Placering efter KM, deltävling 1",
options = list(pageLength = 18)) %>%
formatStyle('Poäng',  color = 'steelblue', fontWeight = 'bold')
# Create a table with the DT package
datatable( tot,
colnames = c("Namn" = "Name", 1 = "Deltävling 1", 2 = "Deltävling 2", "sum_poins" = "Tot Poäng"),
# Create a table with the DT package
datatable( res_1to2,
caption = "Tabell 1: Placering efter KM, deltävling 1",
options = list(pageLength = 18)) %>%
formatStyle('Poäng',  color = 'steelblue', fontWeight = 'bold')
# Create a table with the DT package
datatable( res_1to2,
caption = "Tabell: Placering efter KM, deltävling 2",
options = list(pageLength = 18)) %>%
formatStyle('Poäng',  color = 'steelblue', fontWeight = 'bold')
# Create a table with the DT package
datatable( res_1to2,
colnames = c("Namn" = "Name", "Tävling 1" = 1, "Tävling 2" = 2 , "Poäng" = "sum_points"),
caption = "Tabell: Placering efter KM, deltävling 2",
options = list(pageLength = 18)) %>%
formatStyle('Poäng',  color = 'steelblue', fontWeight = 'bold')
# Create a table with the DT package
datatable( res_1to2,
caption = "Tabell: Placering efter KM, deltävling 2",
options = list(pageLength = 18)) %>%
formatStyle('Poäng',  color = 'steelblue', fontWeight = 'bold')
# Create a table with the DT package
datatable( res_1to2,
options = list(pageLength = 18)) %>%
formatStyle('Poäng',  color = 'steelblue', fontWeight = 'bold')
# Create a table with the DT package
datatable(res_1to2)
### Import result dataset
## Import results from competitions
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
View(comp1)
# Import result from competition no 2
comp2 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no2.xlsx")
View(comp2)
# Import result from competition no 3
# comp3 <-
# View(comp3)
# Import result from competition no 4
# comp4 <-
# View(comp4)
# Import result from competition no 5
# comp5 <-
# View(comp5)
## Aggregate all datasets to one dataset
#For competitions 1-2
tot2 <- bind_rows(comp1, comp2)
View(tot2)
# Add new variable "points"
tot <- comp1 %>% mutate(points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
View(tot)
## Calculate grand total points for all competitions (1-2)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
### Import result dataset
## Import results from competitions
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
View(comp1)
# Import result from competition no 2
comp2 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no2.xlsx")
View(comp2)
# Import result from competition no 3
# comp3 <-
# View(comp3)
# Import result from competition no 4
# comp4 <-
# View(comp4)
# Import result from competition no 5
# comp5 <-
# View(comp5)
## Aggregate all datasets to one dataset
#For competitions 1-2
tot2 <- bind_rows(comp1, comp2)
View(tot2)
# Add new variable "points"
tot <- comp1 %>% mutate(Points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
View(tot)
## Calculate grand total points for all competitions (1-2)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
View(grand_tot_1to2)
##  Change format for output - create "pivot table" with points per competition
piv_comp_1to2 <- tot %>%
select(Name, CompNo, Points) %>%
spread(CompNo, Points)
View(piv_comp_1to2)
# Create new piv df with totals column
res_1to2 <- piv_comp_1to2 %>%
full_join(grand_tot_1to2, by = "Name") %>%
arrange(desc(sum_points))
View(res_1to2)
# Create a table with the DT package
datatable(res_1to2)
library(tidyverse)
library(readr)
library(readxl)
library(DT)
library(kableExtra)
library(ggplot2)
### Import result dataset
## Import results from competitions
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
# View(comp1)
# Import result from competition no 2
comp2 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no2.xlsx")
# View(comp2)
# Import result from competition no 3
# comp3 <-
# View(comp3)
# Import result from competition no 4
# comp4 <-
# View(comp4)
# Import result from competition no 5
# comp5 <-
# View(comp5)
## Aggregate all datasets to one dataset
#For competitions 1-2
tot2 <- bind_rows(comp1, comp2)
View(tot2)
# Add new variable "points"
tot <- comp1 %>% mutate(Points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
View(tot)
## Calculate grand total points for all competitions (1-2)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
View(grand_tot_1to2)
##  Change format for output - create "pivot table" with points per competition
piv_comp_1to2 <- tot %>%
select(Name, CompNo, Points) %>%
spread(CompNo, Points)
View(piv_comp_1to2)
# Create new piv df with totals column
res_1to2 <- piv_comp_1to2 %>%
full_join(grand_tot_1to2, by = "Name") %>%
arrange(desc(sum_points))
View(res_1to2)
## Resultat efter första deltävlingen
```{r prep_results, include=FALSE}
### Import result dataset
## Import results from competitions
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
# View(comp1)
# Import result from competition no 2
comp2 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no2.xlsx")
# View(comp2)
# Import result from competition no 3
# comp3 <-
# View(comp3)
# Import result from competition no 4
# comp4 <-
# View(comp4)
# Import result from competition no 5
# comp5 <-
# View(comp5)
## Aggregate all datasets to one dataset
#For competitions 1-2
tot2 <- bind_rows(comp1, comp2)
View(tot2)
# Add new variable "points"
tot <- comp1 %>% mutate(Points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
View(tot)
## Calculate grand total points for all competitions (1-2)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
View(grand_tot_1to2)
##  Change format for output - create "pivot table" with points per competition
piv_comp_1to2 <- tot %>%
select(Name, CompNo, Points) %>%
spread(CompNo, Points)
View(piv_comp_1to2)
# Create new piv df with totals column
res_1to2 <- tot %>%
full_join(grand_tot_1to2, by = "Name") %>%
arrange(desc(sum_points))
View(res_1to2)
res_1to2 <- piv_comp_1to2 %>%
full_join(grand_tot_1to2, by = "Name") %>%
arrange(desc(sum_points))
View(res_1to2)
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
View(comp1)
# Import result from competition no 2
comp2 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no2.xlsx")
View(comp2)
#For competitions 1-2
tot2 <- bind_rows(comp1, comp2)
View(tot2)
# Add new variable "points"
tot <- tot2 %>% mutate(Points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
View(tot)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
View(grand_tot_1to2)
piv_comp_1to2 <- tot %>%
select(Name, CompNo, Points) %>%
spread(CompNo, Points)
View(piv_comp_1to2)
# Create new piv df with totals column
res_1to2 <- piv_comp_1to2 %>%
full_join(grand_tot_1to2, by = "Name") %>%
arrange(desc(sum_points))
View(res_1to2)
### Import result dataset
## Import results from competitions
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
# View(comp1)
# Import result from competition no 2
comp2 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no2.xlsx")
# View(comp2)
## Aggregate all datasets to one dataset
#For competitions 1-2
tot2 <- bind_rows(comp1, comp2)
View(tot2)
## Calculate points per competition
# Add new variable "points"
tot <- tot2 %>% mutate(Points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
View(tot)
##  Change format for output - create "pivot table" with points per competition
piv_comp_1to2 <- tot %>%
select(Name, CompNo, Points) %>%
spread(CompNo, Points)
View(piv_comp_1to2)
## Calculate grand total points for all competitions (1-2)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
View(grand_tot_1to2)
# Create new piv df with totals column
res_1to2 <- piv_comp_1to2 %>%
full_join(grand_tot_1to2, by = "Name") %>%
arrange(desc(sum_points))
View(res_1to2)
# Create a table with the DT package
datatable(res_1to2)
# Create a table with the DT package
res_1to2 %>%
kable() %>%
kable_styling()
res_1to2 %>%
datatable()
res_1to2 %>%
datatable(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
# Create a table with the DT package
res_1to2 %>%
kable() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
# Create a table with the DT package
res_1to2 %>%
kable() %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive", full_width = F, postition = "left"))
# Create a table with the DT package
res_1to2 %>%
kable() %>%
kable_styling(c(bootstrap_options = "striped", full_width = F, position = "left"), fixed_thead = T)
##  Change format for output - create "pivot table" with points per competition
piv_comp_1to2 <- tot %>%
select(Name, CompNo, Place) %>%
spread(CompNo, Place)
# View(piv_comp_1to2)
## Calculate grand total points for all competitions (1-2)
grand_tot_1to2 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
# View(grand_tot_1to2)
# Create new piv df with totals column
res_1to2 <- piv_comp_1to2 %>%
full_join(grand_tot_1to2, by = "Name") %>%
arrange(desc(sum_points))
# View(res_1to2)
datatable(res_1to2,
colnames = c("Namn" = "Name", "Placering 1" = 1, "Placering 2" = 2, "Poäng" = "sum_points"),
caption = "Placering efter KM",
options = list(pageLength = 18)) %>%
formatStyle('Poäng',  color = 'steelblue', fontWeight = 'bold')
rmarkdown::render_site()
library(tidyverse)
library(readr)
library(readxl)
library(DT)
library(kableExtra)
library(ggplot2)
### Import result dataset
## Import results from competitions
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
rmarkdown::render_site()
install.packages("remotes")
remotes::install_github("rstudio/gt")
install.packages("remotes")
install.packages("remotes")
remotes::install_github("rstudio/gt")
install.packages("devtools", type = "win.binary")
remotes::install_github("rstudio/gt")
librare(blogdown)
library(blogdown)
library(tidyverse)
library(readr)
library(readxl)
library(DT)
library(kableExtra)
library(ggplot2)
### Import result dataset
## Import results from competitions
# Import result dataset from first competition
comp1 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no1.xlsx")
# View(comp1)
# Import result from competition no 2
comp2 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no2.xlsx")
# View(comp2)
# Import result from competition no 3
comp3 <- read_excel("C:/Users/AndrésLagerlöf/OneDrive - Andrés Lagerlöf Konsulttjänst AB/Övrigt/Fäktning/KM/KM_webb/fff_km/Result_no3.xlsx")
# View(comp3)
## Aggregate all datasets to one dataset
#For competitions 1-3
tot2 <- bind_rows(comp1, comp2, comp3)
## Aggregate all datasets to one dataset
#For competitions 1-3
tot2 <- bind_rows(comp1, comp2, comp3)
# View(tot2)
## Calculate points per competition
# Add new variable "points"
tot <- tot2 %>% mutate(Points = case_when(
Place == 1 ~ 25,
Place == 2 ~ 22,
Place == 3 ~ 19,
Place == 4 ~ 17,
Place == 5 ~ 15,
Place == 6 ~ 13,
Place == 7 ~ 12,
Place == 8 ~ 11,
Place == 9 ~ 10,
Place == 10 ~ 9,
Place == 11 ~ 8,
Place == 12 ~ 7,
Place == 13 ~ 6,
Place == 14 ~ 5,
Place == 15 ~ 4,
Place == 16 ~ 3,
Place == 17 ~ 2,
TRUE ~ 1
))
# View(tot)
View(tot)
##  Change format for output - create "pivot table" with points per competition
piv_comp_1to3 <- tot %>%
select(Name, CompNo, Place) %>%
spread(CompNo, Place)
# View(piv_comp_1to3)
## Calculate grand total points for all competitions (1-3)
grand_tot_1to3 <- tot %>% group_by(Name) %>%
summarise(sum_points = sum(Points))
# View(grand_tot_1to3)
# Create new piv df with totals column
res_1to3 <- piv_comp_1to3 %>%
full_join(grand_tot_1to3, by = "Name") %>%
arrange(desc(sum_points))
# View(res_1to3)
View(res_1to3)
